# 3rd_project 테스트 계획서 (Test Plan)

## 📌 프로젝트 개요
- **프로젝트명**: 3rd_project
- **설명**: GitHub 저장소를 분석하고, 임베딩 기반 코드 검색, 자연어 QA, 코드 수정 기능을 제공하는 웹 애플리케이션
- **프레임워크**: Python (Flask)
- **주요 기능**: GitHub 클론, 코드 임베딩, 자연어 질문 응답, 코드 수정 요청, Git 커밋

## 🔖 테스트 범위 및 전략
| 기능 영역 | 테스트 유형 | 목적 |
|-----------|-------------|------|
| app.py API 라우트 | API 테스트 | 각 엔드포인트 정상 응답 및 예외 처리 검증 |
| github_analyzer.py | 단위 테스트, 통합 테스트 | 저장소 클론 및 파일 필터링, 임베딩 정확성 확인 |
| chat_handler.py | 통합 테스트 | 질문/수정 요청 처리 흐름 확인, OpenAI 연동 검증 |
| chat_memory.py | 단위 테스트 | 대화 저장 및 검색 기능 테스트 |
| 프론트엔드 동작 | 기능 테스트 (수동/자동) | 버튼 클릭 → API 연동 여부, 파일 업로드 등 |
| DB 및 세션 관리 | 통합 테스트 | 세션 ID 생성, 상태 파일 업데이트 검증 |
| 예외 및 로깅 | 오류 테스트 | 비정상 입력 시 처리, 로그 출력 여부 |

## 🧪 테스트 케이스 요약

### 🔹 1. API 테스트 (app.py)
| ID | 기능 | 입력 | 예상 결과 |
|----|------|------|-----------|
| A1 | /analyze 호출 | 유효한 repo URL, 토큰 | 상태 파일 생성, 분석 시작 |
| A2 | /analyze 호출 | 잘못된 URL | 400 에러, 에러 메시지 반환 |
| A3 | /chat 호출 | 질문 JSON | 코드 기반 응답 반환 |
| A4 | /modify_request 호출 | 수정 요청 | diff 형식 응답 반환 |
| A5 | /apply_changes 호출 | 변경 승인 | 파일 변경 + 커밋 수행 |

### 🔹 2. 저장소 분석 기능 (github_analyzer.py)
| ID | 기능 | 입력 | 예상 결과 |
|----|------|------|-----------|
| G1 | 저장소 클론 | 공개 repo URL | 로컬에 repo 디렉토리 생성됨 |
| G2 | 파일 필터링 | 다양한 확장자 | .py, .js, .md 등만 포함됨 |
| G3 | 디렉토리 구조 생성 | repo 경로 | 마크다운 트리 문자열 반환 |
| G4 | 임베딩 수행 | 파싱된 코드 청크 | 벡터 저장소에 문서 추가됨 |

### 🔹 3. 채팅 기능 (chat_handler.py)
| ID | 기능 | 입력 | 예상 결과 |
|----|------|------|-----------|
| C1 | 일반 질문 처리 | "이 함수 뭐하는 거야?" | 관련 청크 위치와 설명 포함 응답 |
| C2 | 역할 태깅 | "로그인 기능 어딨어?" | "사용자 인증"으로 추출됨 |
| C3 | 코드 수정 요청 | "에러 핸들링 추가해줘" | diff 형식 반환 |
| C4 | Git 푸시 의도 감지 | "main 브랜치로 푸시할까?" | 관련 의도 응답 반환 |

### 🔹 4. 대화 저장 기능 (chat_memory.py)
| ID | 기능 | 입력 | 예상 결과 |
|----|------|------|-----------|
| M1 | 이전 대화 저장 | 질문/응답 | 세션별 메모리 파일에 기록됨 |
| M2 | 유사 질문 검색 | 새로운 질문 | 관련 히스토리 반환 |

### 🔹 5. 프론트엔드 테스트 (기능 테스트)
| ID | 기능 | 시나리오 | 결과 |
|----|------|----------|------|
| F1 | 저장소 URL 입력 | 입력 후 분석 버튼 클릭 | 분석 상태 메시지 출력 |
| F2 | 질문 입력 | 채팅창에 입력 | 응답이 화면에 출력 |
| F3 | 코드 수정 요청 | diff 미리보기 표시 | 적용 버튼 클릭 시 반영 |

### 🔹 6. 예외 및 보안
| ID | 기능 | 상황 | 결과 |
|----|------|------|------|
| E1 | 잘못된 토큰 | repo_url + invalid token | 인증 에러 발생 |
| E2 | 임베딩 실패 | 파싱 불가능한 코드 | 오류 메시지 및 로그 기록 |
| E3 | OpenAI API Key 없음 | 질문 전송 | 인증 에러 반환, 처리 불가 로그 |

## 📂 테스트 폴더 구조 제안
```
tests/
├── __init__.py
├── test_app.py
├── test_github_analyzer.py
├── test_chat_handler.py
├── test_chat_memory.py
├── test_utils.py
└── test_data/
    ├── sample_repo/
    └── input_examples.json
```

## ✅ 테스트 도구 및 실행
| 항목 | 도구/방법 |
|------|-----------|
| 유닛 테스트 | pytest, unittest |
| 통합 테스트 | requests, Flask test client |
| 프론트엔드 테스트 | 수동 또는 Selenium |
| 커버리지 측정 | coverage, pytest-cov |
| Mocking | unittest.mock, pytest-mock |

## 📌 마무리 체크리스트
- 저장소 URL 및 토큰 처리 정상작동
- 역할 태깅 정확도 확인
- 질문에 대한 컨텍스트 응답 포함 여부 확인
- diff 적용 기능 동작 및 Git 반영 확인
- 오류 처리 및 로그 파일 검증
- 이전 대화 기록 추적 및 활용 검증 